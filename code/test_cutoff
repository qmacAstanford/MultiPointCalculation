   



for pt=1:npts

    x1=log(a);
    x2=log(b);
    x3=log(c);
    if( min([a,b,c])<0)
        error('inputs must be positive')
    end
    if a*b*c==0
        out=0;
        return 
    end
    %[a,b,c]=offset(a,b,c,3.0e-6); %keeps a and b and c different
    
    cut=0.2;
    cut1=0.01;
    order=sort([c,b,a]);
    a=order(3);b=order(2);c=order(1); % a > b > c
    


        % 1~a~b~c 
        oabc(pt)=-N*(N-1)*(N-2)*(N-3)*((N+1)*(3-a-b-c)-5)/120;

        % a~b~c !~ 1
        % I have measured w.r.t. c as this gives best results
        M1=[...
            0   0   0   0;...
            -1  6   -11 6;...
            3   -12 3   18;...
            -3  6   9   0;...
            1   0   -1  0;...
            0   0   0   0;...
            0   0   0   0;...
            0   0   -6  -6;...
            0   0   6   -18];

        M2=[...
            0   3   -15 18;...
            0   -9  33  -18;...
            0   9   -21 0;...
            0   -3  3   0;...
            0   0   0   0;...
            0   0   -6  0;...
            0   0   12  -18;...
            0   0   -6  18;...
            0   0   0   0];

        vL=(c*ones(1,9)).^[N+4,N+3,N+2,N+1,N,5,4,3,2];
        vR=[N^3;N^2;N;1];

        o_acb(pt)=vL*(M1*((b-a)+2*(c-b))+M2)*vR/(6*(c-1)^5);
    
        %  1~a~b !~ c
        delta_ab=0.139;
        delta_1a=0.149087;

        M1=...
        [1,-2,-1,2,0;...
         -4,12,4,-12,0;...
         6,-24,6,36,0;...
         -4,20,-20,-20,24;...
         1,-6,11,-6,0];

        M2=...
        [0,2,-6,4,0;...
         0,-8,30,-22,0;...
         0,12,-54,54,0;...
         0,-8,42,-58,12;...
         0,2,-12,22,-12];

        vL=[c^5,c^4,c^3,c^2,c];
        vR=[N^4;N^3;N^2;N;1];

        oab_c(pt)=(vL*( (delta_ab+2*delta_1a)*M1-2*M2 )*vR...
            -(delta_ab+2*delta_1a)*24*c^(N+2)...
            -24*c^(N+1)+24*c^(N+2) )...
            /(24*(c-1)^5);
    
        % 1~a !~ b~c
        M1=[...
            0   0   -6  18;...
            0   0   6   6;...
            0   0   0   0;...
            0   0   0   0;...
            -1  0   1   0;...
            3   -6  -9  0;...
            -3  12  -3  -18;...
            1   -6  11  -6;...
            0   0   0   0];
        M2=[...
            0   0   0   0;...
            0   -3  15  -18;...
            0   6   -12 -18;...
            0   -3   -3 0;...
            0   0   0   0;...
            0   0   0   0;...
            0   3   3   0;...
            0   -6  12  18;...
            0   3   -15 18];
        M3=[...
            0   0   6   -18;...
            0   0   -12 18;...
            0   0   6   0;...
            0   0   0   0;...
            0   3   -3  0;...
            0   -9  21  0;...
            0   9   -33 18;...
            0   -3  15  -18;...
            0   0   0   0];
        vL=(c*ones(1,9)).^[N+3,N+2,N+1,N,5,4,3,2,1];
        vR=[N^3;N^2;N;1];

        oa_bc(pt)=vL*(M1*(1-a)+ M2*(c-b) + M3)*vR/(6*(c-1)^5);

        % 1~a !~ b !~ c
        M1=[...
            1   0   -1  -6;...
            -3  3   6   18;...
            3   -6  -3  -12;...
            -1  3   -2  6];
        M2=[...
            0   -3  3   6;...
            0   9   -15 -18;...
            0   -9  21  12;...
            0   3   -9  0];
        M3=[...
            -2  3   5   -6;...
            6   -15 -15 24;...
            -6  21  3   -36;...
            2   -9  7   6];
        M4=[...
            0   6   -12 0;...
            0   -18 48  -6;...
            0   18  -60 24;...
            0   -6  24  -18];
        M5=[...
            1   -3  2   0;...
            -3  12  -9  0;...
            3   -15 18  0;...
            -1  6   -11 6];
        M6=[...
            0   -3  9   -6;...
            0   9   -33 24;...
            0   -9  39  -36;...
            0   3   -15 18];
        M7=[...
            -18 18  -6;...
            18  -6  0;...
            -6  0   0];
        M8=[...
            12  -18 6;...
            -18 24  -6;...
            6   -6  0];
        alpha1=((c*ones(1,4)).^[5,4,3,2])*(M1*(1-a)*b^3+...
                                           M2*b^3+...
                                           M3*(1-a)*b^2+...
                                           M4*b^2+...
                                           M5*(1-a)*b+...
                                           M6*b)*((N*ones(4,1)).^[3;2;1;0]);
        alpha2=[b^3,b^2,b]*(M7*(1-a)+M8)*[c^(N+2);c^(N+1);c^N];

        alpha3=b*(b*(1-a)-b+1) * ((c^2-c^3)*b^N+(c^3-c^N)*b^2+(c^N-c^2)*b^3)/...
               ( c*(b-c)*(b-1)*(c-1) );
        oa_b_c(pt)=-(b-1)^(-3)*((alpha1+alpha2)/(6*c*(c-1)^4) -alpha3);  

        % 1 !~ a~b !~ c
         M1=[...
             0  0   N^2-5*N+6;...
             0  8*N-2*N^2-6   6*N-2*N^2;...
             N^2-3*N+2  4*N^2-8*N-8 N^2-N-2;...
             2*N-2*N^2+4    6-2*N^2 0;...
             N^2+N-2    0   0;...
             -2 -4  -4;...
             8  12  0;...
             -10    0   0];
         M2=[0  0   3   -6  3;...
             0  -2  3   0   -1;...
             0  0   0   0   0;...
             -1 0   0   0   1;...
             3  0   0   0   -3;...
             -3 0   -3  6   0;...
             1  2   -3  0   0];
         M3=[...
             0  0   -1  2   -1;...
             0  1   -1  -1  1;...
             0  -1  2   -1  0;...
             0  0   0   1   -1;...
             0  0   -2  1   1;...
             0  1   1   -2  0;...
             0  -1  1   0   0];

         T1=c*(b-1)^(-2)*((b*ones(1,8)).^[N+4,N+3,N+2,N+1,N,5,4,3])*M1*[c^2;c;1];

         T2=-2*b^2*(c^3-c^N)*(b-2*c+b*c)/(c-1);

         T3=-c^2*(1-c)*(b^4-b^(N+1))*(1-b)^(-1)...
            +b^2*(1-b)*(c^4-c^(N+1))*(1-c)^(-1)...
            +b^2*c^2*(b-c)*(N-3);
         T4=b*c*( (b-c)^2*(b-1)^3*(c-1)^2 )^(-1)*...
             ((b*ones(1,7)).^[N+2,N+1,N,4,3,2,1])*...
             (M2+M3*N)*...
             ((c*ones(5,1)).^[N;3;2;1;0]);

        o_ab_c(pt)=(a-b)*( (T1-T2)/(2*(b-1)^2*(b-c)^3) + T3/(b*c*(b-c)*(b-1)^3*(c-1)))-T4;
        
   
        % 1 !~ a !~ b~c
        %This is the same as above with a and c switched
        a=order(1);b=order(2);c=order(3);
         M1=[...
             0  0   N^2-5*N+6;...
             0  8*N-2*N^2-6   6*N-2*N^2;...
             N^2-3*N+2  4*N^2-8*N-8 N^2-N-2;...
             2*N-2*N^2+4    6-2*N^2 0;...
             N^2+N-2    0   0;...
             -2 -4  -4;...
             8  12  0;...
             -10    0   0];
         M2=[0  0   3   -6  3;...
             0  -2  3   0   -1;...
             0  0   0   0   0;...
             -1 0   0   0   1;...
             3  0   0   0   -3;...
             -3 0   -3  6   0;...
             1  2   -3  0   0];
         M3=[...
             0  0   -1  2   -1;...
             0  1   -1  -1  1;...
             0  -1  2   -1  0;...
             0  0   0   1   -1;...
             0  0   -2  1   1;...
             0  1   1   -2  0;...
             0  -1  1   0   0];

         T1=c*(b-1)^(-2)*((b*ones(1,8)).^[N+4,N+3,N+2,N+1,N,5,4,3])*M1*[c^2;c;1];

         T2=-2*b^2*(c^3-c^N)*(b-2*c+b*c)/(c-1);

         T3=-c^2*(1-c)*(b^4-b^(N+1))*(1-b)^(-1)...
            +b^2*(1-b)*(c^4-c^(N+1))*(1-c)^(-1)...
            +b^2*c^2*(b-c)*(N-3);
         T4=b*c*( (b-c)^2*(b-1)^3*(c-1)^2 )^(-1)*...
             ((b*ones(1,7)).^[N+2,N+1,N,4,3,2,1])*...
             (M2+M3*N)*...
             ((c*ones(5,1)).^[N;3;2;1;0]);

        o_a_bc(pt)=(a-b)*( (T1-T2)/(2*(b-1)^2*(b-c)^3) + T3/(b*c*(b-c)*(b-1)^3*(c-1)))-T4;
        a=order(3);b=order(2);c=order(1); % put back in origional order
    
        % a !~ b !~ c
        outs=[0;0;0;0];
        v1=[x1,x1,x3,x3,x1-x3,3*x2-N*x2];
        v2=[expl(2,x1),expl(2,x1),expl(2,x3),expl(2,x3),...
            expl(2,x1)-expl(2,x3),expl(2,3*x2)-expl(2,N*x2)];
        outs(1)= hooperHumperdink(v1,v2);

        v1=[x2,x2,x3,x3,x2-x3,3*x1-N*x1];
        v2=[expl(2,x2),expl(2,x2),expl(2,x3),expl(2,x3),...
            expl(2,x2)-expl(2,x3),expl(2,3*x1)-expl(2,N*x1)];
        outs(2)=(-1)*hooperHumperdink(v1,v2);

        v1=[x1,x1,x2,x2,x1-x2,3*x3-N*x3];
        v2=[expl(2,x1),expl(2,x1),expl(2,x2),expl(2,x2),...
            expl(2,x1)-expl(2,x2),expl(2,3*x3)-expl(2,N*x3)];
        outs(3)=(-1)*hooperHumperdink(v1,v2);

        v1=[x1,x2,x3,x1-x2,x1-x3,x2-x3];
        v2=[expl(2,x1),expl(2,x2),expl(2,x3),...
            expl(2,x1)-expl(2,x2),...
            expl(2,x1)-expl(2,x3),...
            expl(2,x2)-expl(2,x3)];
        outs(4)=hooperHumperdink(v1,v2)*(3-N);
        out=sum(outs);
        
        a_b_c(pt)=out*a*b*c*( (a-1)^2*(b-1)^2*(c-1)^2*(a-b)*(a-c)*(b-c) )^(-1);
    end 
end